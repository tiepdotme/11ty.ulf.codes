{%- if onsubmit == nil or onsubmit == "" -%}
    {%- assign onsubmit = "submitQuery(event);"%}
{%- endif -%}
{%- if focus -%}
    {%- assign autofocus = "autofocus" -%}
{%- endif -%}

<form onsubmit="{{onsubmit}}">
    {%- if site.searchKey -%}
        <label id="search-label" for="search-query" class="small">Search <em>{{site.name}},</em> press {{site.searchKey}} to focus:</label>
    {%- else -%}
        <label id="search-label" for="search-query" class="small">Search <em>{{site.name}}</em>:</label>
    {%- endif -%}

</label>
<div class="flex mxw-sm">
    <input id="search-query" {{autofocus}} class="w-100" type="text"/>
    <input type="submit" style="border-top-left-radius: 0px; border-bottom-left-radius: 0px;" value="Search"/>
</div>
</form>
<script>
function submitQuery(event) {
    event.preventDefault();
    let query = event
        .target['search-query']
        .value;
    if (query && query.trim()) {
        location.href = '{{site.search}}?query=' + encodeURIComponent(query.trim());
    } else {
        location.href = '{{site.search}}';
    }
}
</script>